import{f as I,r as o,k as B,g as y,b as p,h as q,j as s,L as A,E as T,i as Z,l as O,m as z,s as V,p as G}from"./index-C_4GKcXO.js";import{u as H}from"./index.esm-D2pPP2Os.js";import{S as J}from"./Saving-DKPS-b8t.js";import{S as K}from"./SuccessNotification-BAm-q0VH.js";import{B as Q}from"./index-DOc7TYCd.js";const ee=({editMode:l=!1})=>{const{courseId:c}=I(),{register:g,handleSubmit:N,setValue:b,watch:U,formState:{errors:m}}=H(),[i,h]=o.useState(["courseName","description","fee","webinars","imageUrl"]),n=U("imageUrl"),[d,f]=o.useState(),[C,w]=o.useState(!1),[E,x]=o.useState(!0),[F,S]=o.useState(!1),[R,j]=o.useState(!1),$=B(),v=y();o.useEffect(()=>{if(l&&c){const e=y(),a=p(e,`coursesPage2/${c}`);q(a).then(r=>{if(r.exists()){const t=r.val();Object.keys(t).forEach(u=>b(u,t[u])),f(t.imageUrl)}else console.log("No data available");x(!1)}).catch(r=>{console.error(r),x(!1)})}else x(!1)},[l,c,b]),o.useEffect(()=>{if(n&&n.length>0&&n[0]instanceof File){const e=new FileReader;e.onload=a=>f(a.target.result),e.readAsDataURL(n[0])}else f(n)},[n]);const D=async e=>{w(!0);try{let a=d;if(e.imageUrl&&e.imageUrl[0]instanceof File){const t=e.imageUrl[0],u=Z($,`coursesPage2/${t.name}`);await O(u,t),a=await z(u)}const r={...e,imageUrl:a};if(l&&c){const t=p(v,`coursesPage2/${c}`);await V(t,r),console.log("Course data updated successfully!",r)}else{const t=p(v,"coursesPage2");await G(t,r),console.log("Course data submitted successfully!",r)}S(!0)}catch(a){console.log("Error adding/updating course data: ",a),j(!0)}finally{w(!1)}},P=e=>{const a=new Set(i),r=e.every(t=>a.has(t));h(r?i.filter(t=>!e.includes(t)):[...i,...e.filter(t=>!a.has(t))])},L={Basic:["courseName","description","fee"],Additional:["webinars"],Media:["imageUrl"]};o.useEffect(()=>{g("imageUrl",{required:"This field is required"})},[g]);const k=e=>e.includes("Date")?"date":e.includes("Time")?"time":"text";return E?s.jsx(A,{}):s.jsxs(s.Fragment,{children:[C&&s.jsx(J,{}),s.jsxs("div",{className:"flex flex-col sm:flex-row",children:[s.jsx("div",{className:"flex flex-col space-y-2 p-3 lg:p-6 md:w-1/3",children:Object.entries(L).map(([e,a])=>s.jsxs("button",{onClick:()=>P(a),className:`text-sm lg:text-base py-2 px-4 rounded transition duration-300 flex items-center gap-2 ${i.some(r=>a.includes(r))?"bg-red-500 hover:bg-red-700":"bg-blue-500 hover:bg-blue-700"} text-white`,children:[s.jsx(Q,{})," ",i.some(r=>a.includes(r))?"Remove":"Add"," ",e.replace(/([A-Z])/g," $1").replace("Section"," Section")]},e))}),s.jsxs("form",{onSubmit:N(D),className:"p-3 lg:p-6 bg-white shadow-lg rounded-lg flex-grow space-y-4 md:w-2/3",children:[s.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-indigo-600",children:l?"Edit Course Details":"Course Details"}),F&&s.jsx(K,{message:l?"Course Updated Successfully!":"Course Created Successfully!",onClose:()=>S(!1)}),R&&s.jsx(T,{message:"Something went wrong!",onClose:()=>j(!1)}),i.map(e=>s.jsxs("div",{className:"relative",children:[s.jsxs("label",{className:"block text-sm lg:text-base font-medium text-gray-700 capitalize",children:[e.replace(/([A-Z])/g," $1"),e!=="webinars"&&s.jsx("span",{className:"text-red-500",children:"*"})]}),e==="imageUrl"?s.jsxs("div",{children:[s.jsx("input",{type:"file",...g("imageUrl"),className:"mt-1 block w-full pl-3 py-2 text-sm lg:text-base text-gray-900 border border-gray-300 rounded-md shadow-sm cursor-pointer focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"}),d&&s.jsx("img",{src:d,alt:"Preview",className:"mt-4 h-48 w-auto border rounded-md"})]}):s.jsx("input",{type:k(e),...g(e,{required:e!=="webinars",minLength:{value:3,message:"Minimum length is 3 characters"}}),className:`mt-1 block w-full pl-3 pr-12 py-2 border ${m[e]?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`,placeholder:`Enter ${e.replace(/([A-Z])/g," $1")}`}),m[e]&&s.jsx("p",{className:"mt-1 text-sm lg:text-base text-red-500",children:m[e].message})]},e)),s.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:l?"Update Course Details":"Submit Course Details"})]})]})]})};export{ee as default};
