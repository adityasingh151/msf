import{f as U,u as F,r as a,g as f,b as m,h as $,j as e,L as C,E as I,R as T,i as q,k as V,l as A,m as B,n as P,p as Q}from"./index-C1Md3IU_.js";import{u as z}from"./index.esm-CSBi2Yp2.js";import{S as G}from"./Saving-5cbZdhLL.js";import{S as H}from"./SuccessNotification-BG_7mmcG.js";const W=({onSave:y=()=>{}})=>{const{resourceId:s}=U(),S=F(),{register:x,handleSubmit:N,setValue:g,watch:v,formState:{errors:l}}=z({defaultValues:{title:"",description:"",file:null}}),c=v("file"),[R,p]=a.useState(!1),[E,i]=a.useState(!0),[k,n]=a.useState(!1),[D,d]=a.useState(!1),[h,b]=a.useState("");a.useEffect(()=>{if(s){const u=f(),r=m(u,`resources/${s}`);$(r).then(t=>{if(t.exists()){const o=t.val();g("title",o.title),b(o.description),i(!1)}else console.error("Resource not found"),i(!1)}).catch(t=>{console.error("Error fetching resource:",t),i(!1)})}else i(!1)},[s,g]);const L=async u=>{p(!0),n(!1),d(!1);try{let r="";if(c&&c.length>0){const j=c[0],w=q(V(),`resources/${j.name}`);await A(w,j),r=await B(w)}const t=s?m(f(),`resources/${s}`):m(f(),"resources"),o={title:u.title,description:h,link:r||null};s?await P(t,o):await Q(t,o),n(!0),y(),S("/admin/view/resources")}catch(r){console.error("Error saving resource:",r),d(!0)}finally{p(!1)}};return E?e.jsx(C,{}):e.jsxs(e.Fragment,{children:[R&&e.jsx(G,{}),e.jsxs("form",{onSubmit:N(L),className:"p-6 bg-white shadow-lg rounded-lg relative",children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-600 mb-4",children:s?"Edit Resource":"Upload Resource Document"}),k&&e.jsx("div",{className:"fixed top-0 left-1/2 transform -translate-x-1/2",children:e.jsx(H,{message:"Resource saved successfully!",onClose:()=>n(!1)})}),D&&e.jsx("div",{className:"fixed top-0 left-1/2 transform -translate-x-1/2",children:e.jsx(I,{message:"Failed to save resource!",onClose:()=>d(!1)})}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Resource Title ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"text",...x("title",{required:"Title is required"}),className:`mt-1 block w-full pl-3 py-2 text-base text-gray-900 border ${l.title?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`}),l.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.title.message})]})}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Upload File ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"file",accept:"application/pdf",...x("file"),className:"mt-1 block w-full pl-3 py-2 text-base text-gray-900 border border-gray-300 rounded-md shadow-sm cursor-pointer focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})}),e.jsxs("div",{className:"my-4",children:[e.jsx("label",{className:"block text-base font-medium text-gray-700",children:"Description"}),e.jsx(T,{value:h,onChange:b,placeholder:"Add a description for the resource"})]}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded",children:s?"Update Resource":"Submit Resource"})]})]})};export{W as default};
