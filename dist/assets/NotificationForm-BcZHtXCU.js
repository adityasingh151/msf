import{r,j as e,L as k,E as R,i as $,k as q,l as C,m as D,F as I,b as g,g as h,n as Y,p as H}from"./index-C_4GKcXO.js";import{u as T}from"./index.esm-D2pPP2Os.js";import{S as V}from"./Saving-DKPS-b8t.js";import{S as B}from"./SuccessNotification-BAm-q0VH.js";const J=({existingData:t,onSave:x=()=>{}})=>{const{register:c,handleSubmit:b,setValue:f,watch:S,formState:{errors:o}}=T({defaultValues:{heading:t?t.heading:"",pdfFile:t?t.pdfUrl:null}});S("pdfFile");const[j,m]=r.useState(!1),[N,y]=r.useState(!0),[w,i]=r.useState(!1),[F,d]=r.useState(!1);r.useEffect(()=>{const s=setTimeout(()=>{y(!1)},1e3);return()=>clearTimeout(s)},[]),r.useEffect(()=>{t&&f("heading",t.heading)},[t,f]);const E=()=>{const s=new Date,a={day:"numeric",month:"long"},n=s.toLocaleDateString("en-US",a),l=s.getFullYear().toString();return{formattedDate:n,formattedYear:l}},v=async s=>{m(!0),i(!1),d(!1);try{const a=s.pdfFile[0],n=$(q(),`notifications/${a.name}`);await C(n,a);const l=await D(n),{formattedDate:U,formattedYear:L}=E(),P=I().toISOString(),u=t?g(h(),`notifications/${t.id}`):g(h(),"notifications"),p={heading:s.heading,pdfUrl:l,date:U,year:L,timestamp:P};t?(await Y(u,p),i(!0)):(await H(u,p),i(!0)),x()}catch(a){console.error("Error uploading PDF: ",a),d(!0)}finally{m(!1)}};return N?e.jsx(k,{}):e.jsxs(e.Fragment,{children:[j&&e.jsx(V,{}),e.jsxs("form",{onSubmit:b(v),className:"p-6 bg-white shadow-lg rounded-lg relative",children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-600 mb-4",children:t?"Edit Notification":"Upload Notification PDF"}),w&&e.jsx("div",{className:"fixed top-0 left-1/2 transform -translate-x-1/2",children:e.jsx(B,{message:"PDF uploaded successfully!",onClose:()=>i(!1)})}),F&&e.jsx("div",{className:"fixed top-0 left-1/2 transform -translate-x-1/2",children:e.jsx(R,{message:"Failed to upload PDF!",onClose:()=>d(!1)})}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Notification Heading ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"text",...c("heading",{required:"Heading is required"}),className:`mt-1 block w-full pl-3 py-2 text-base text-gray-900 border ${o.heading?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`}),o.heading&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.heading.message})]})}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Upload PDF ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"file",accept:"application/pdf",...c("pdfFile",{required:"PDF file is required"}),className:`mt-1 block w-full pl-3 py-2 text-base text-gray-900 border ${o.pdfFile?"border-red-500":"border-gray-300"} rounded-md shadow-sm cursor-pointer focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`}),o.pdfFile&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.pdfFile.message})]})}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded",children:t?"Update Notification":"Submit Notification"})]})]})};export{J as default};
