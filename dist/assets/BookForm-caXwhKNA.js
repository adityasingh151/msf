import{r as i,u as N,D as E,j as e,L as w,R as c,E as y,g as B,b as m,n as T,p as C}from"./index-C1Md3IU_.js";import{u as L}from"./index.esm-CSBi2Yp2.js";import{S as R}from"./Saving-5cbZdhLL.js";import{S as D}from"./SuccessNotification-BG_7mmcG.js";const U=()=>{var d;const{register:F,handleSubmit:x,setValue:a,reset:f,formState:{errors:r}}=L(),[b,u]=i.useState(!1),[p,g]=i.useState(!0),[j,l]=i.useState(!1),[S,n]=i.useState(!1),k=N(),s=(d=E().state)==null?void 0:d.editData;i.useEffect(()=>{s&&(a("title",s.title),a("author",s.author),a("publisher",s.publisher)),g(!1)},[s,a]);const v=async t=>{u(!0);const h=B();try{if(s){const o=m(h,`books/${s.id}`);await T(o,t)}else{const o=m(h,"books");await C(o,t)}f(),l(!0),setTimeout(()=>{l(!1),k("/admin/view/books")},2e3)}catch(o){console.error("Error saving book: ",o),n(!0),setTimeout(()=>n(!1),2e3)}finally{u(!1)}};return p?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[b&&e.jsx(R,{}),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:s?"Edit Book":"Add New Book"}),e.jsxs("form",{onSubmit:x(v),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx(c,{value:s?s.title:"",onChange:t=>a("title",t),placeholder:"Enter the book title"}),r.title&&e.jsx("p",{className:"text-red-500 text-xs italic",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Author"}),e.jsx(c,{value:s?s.author:"",onChange:t=>a("author",t),placeholder:"Enter the author's name"}),r.author&&e.jsx("p",{className:"text-red-500 text-xs italic",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Publisher"}),e.jsx(c,{value:s?s.publisher:"",onChange:t=>a("publisher",t),placeholder:"Enter the publisher's name"}),r.publisher&&e.jsx("p",{className:"text-red-500 text-xs italic",children:"This field is required"})]}),e.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:s?"Update Book":"Add Book"})]}),j&&e.jsx(D,{message:"Book submitted successfully!",onClose:()=>l(!1)}),S&&e.jsx(y,{message:"Failed to submit book!",onClose:()=>n(!1)})]})]})};export{U as default};
