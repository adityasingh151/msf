import{r as a,D as R,j as e,L,E as k,i as F,k as $,l as q,m as P,g as C,b as w,n as T,p as A}from"./index-C1Md3IU_.js";import{u as B}from"./index.esm-CSBi2Yp2.js";import{S as V}from"./Saving-5cbZdhLL.js";import{S as z}from"./SuccessNotification-BG_7mmcG.js";const O=({existingSponsor:l})=>{var x;const{register:m,handleSubmit:S,watch:y,setValue:d,formState:{errors:i}}=B(),n=y("imageUrl"),[u,c]=a.useState((l==null?void 0:l.imageUrl)||null),[j,g]=a.useState(!1),[U,I]=a.useState(!0),[D,p]=a.useState(!1),[E,f]=a.useState(!1),s=((x=R().state)==null?void 0:x.sponsor)||{};a.useEffect(()=>{s&&(d("sponsorName",s.sponsorName),d("sponsorDetails",s.sponsorDetails),c(s.imageUrl))},[s,d]),a.useEffect(()=>{if(n&&n.length>0){const o=new FileReader;o.onload=r=>c(r.target.result),o.readAsDataURL(n[0])}else s.imageUrl||c(null)},[n,s.imageUrl]),a.useEffect(()=>{const o=setTimeout(()=>{I(!1)},1e3);return()=>clearTimeout(o)},[]);const v=async o=>{g(!0);try{let r=s.imageUrl;if(o.imageUrl&&o.imageUrl[0]){const t=o.imageUrl[0],N=F($(),`sponsorsImages/${t.name}`);await q(N,t),r=await P(N)}const b=C(),h={sponsorName:o.sponsorName,sponsorDetails:o.sponsorDetails,imageUrl:r};if(s.id){const t=w(b,`sponsorsImages/${s.id}`);await T(t,h)}else{const t=w(b,"sponsorsImages");await A(t,h)}p(!0)}catch(r){console.error("Error uploading image: ",r),f(!0)}finally{g(!1)}};return U?e.jsx(L,{}):e.jsxs(e.Fragment,{children:[j&&e.jsx(V,{}),e.jsxs("form",{onSubmit:S(v),className:"p-6 bg-white shadow-lg rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-600 mb-4",children:s.id?"Edit Sponsor Image":"Upload Sponsor Image"}),D&&e.jsx(z,{message:"Image uploaded successfully!",onClose:()=>p(!1)}),E&&e.jsx(k,{message:"Failed to upload image!",onClose:()=>f(!1)}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Sponsor Name ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"text",...m("sponsorName",{required:"Sponsor name is required"}),className:`mt-1 block w-full pl-3 py-2 text-base text-gray-900 border ${i.sponsorName?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`}),i.sponsorName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.sponsorName.message})]})}),e.jsx("div",{className:"my-4",children:e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Sponsor Details",e.jsx("textarea",{...m("sponsorDetails"),className:"mt-1 block w-full pl-3 py-2 text-base text-gray-900 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})}),e.jsxs("div",{className:"my-4",children:[e.jsxs("label",{className:"block text-base font-medium text-gray-700",children:["Upload Image ",s.id?"":e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("input",{type:"file",...m("imageUrl",{required:!s.imageUrl&&"Image is required"}),className:`mt-1 block w-full pl-3 py-2 text-base text-gray-900 border ${i.imageUrl?"border-red-500":"border-gray-300"} rounded-md shadow-sm cursor-pointer focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`})]}),u&&e.jsx("img",{src:u,alt:"Preview",className:"mt-4 h-48 w-auto border rounded-md"})]}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded",children:s.id?"Update Sponsor":"Submit Sponsor"})]})]})};export{O as default};
