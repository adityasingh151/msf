import{r as n,f as H,j as e,L as J,q as K,b as S,g as v,h as Q,i as V,k as W,l as X,m as Y,n as Z,p as _}from"./index-C1Md3IU_.js";import{u as ee}from"./index.esm-CSBi2Yp2.js";import{a as b,B as I}from"./index-DZXT9Nwh.js";import{S as te}from"./Saving-5cbZdhLL.js";const ae=()=>{const{register:j,handleSubmit:U,watch:h,formState:{errors:m},setError:y,clearErrors:w,reset:$}=ee(),[i,E]=n.useState({student:!1,teacher:!1,college:!1,method:!1}),[d,N]=n.useState({}),[P,C]=n.useState(!1),[B,O]=n.useState(!0),[D,T]=n.useState({message:"",type:""});n.useState(!1);const{courseId:l,category:g}=H(),q=h("studentImage"),k=h("teacherImage"),L=h("collegeImage"),z=h("methodImage");n.useEffect(()=>{(async()=>{if(l&&g){const s=S(v(),`courses/${l}/${g}`),a=await Q(s);if(a.exists()){const r=a.val();E({[g]:!0}),$({studentTitle:r.title,studentDescription:r.description,studentImage:r.imgSrc,teacherTitle:r.title,teacherDescription:r.description,teacherImage:r.imgSrc,collegeTitle:r.title,collegeDescription:r.description,collegeImage:r.imgSrc,methodTitle:r.title,methodDescription:r.description,methodImage:r.imgSrc}),N({[`${g}Image`]:r.imgSrc})}}O(!1)})()},[l,g,$]),n.useEffect(()=>{const t=(s,a)=>{s&&s.length>0&&s[0]instanceof File?N(r=>({...r,[a]:URL.createObjectURL(s[0])})):typeof s=="string"&&N(r=>({...r,[a]:s}))};t(q,"studentImage"),t(k,"teacherImage"),t(L,"collegeImage"),t(z,"methodImage")},[q,k,L,z]);const A=async t=>{C(!0);try{const s=async(p,G)=>{const R=V(W(),G);return await X(R,p),await Y(R)},a=i.student?t.studentImage.length>0?await s(t.studentImage[0],`courses/students/${t.studentImage[0].name}`):d.studentImage:"",r=i.teacher?t.teacherImage.length>0?await s(t.teacherImage[0],`courses/teachers/${t.teacherImage[0].name}`):d.teacherImage:"",u=i.college?t.collegeImage.length>0?await s(t.collegeImage[0],`courses/college/${t.collegeImage[0].name}`):d.collegeImage:"",M=i.method?t.methodImage.length>0?await s(t.methodImage[0],`courses/methods/${t.methodImage[0].name}`):d.methodImage:"",o={};i.student?(o.title=t.studentTitle,o.description=t.studentDescription,o.imgSrc=a):i.teacher?(o.title=t.teacherTitle,o.description=t.teacherDescription,o.imgSrc=r):i.college?(o.title=t.collegeTitle,o.description=t.collegeDescription,o.imgSrc=u):i.method&&(o.title=t.methodTitle,o.description=t.methodDescription,o.imgSrc=M),Object.keys(o).forEach(p=>{o[p]===void 0&&delete o[p]}),console.log("Submitting course data:",o);const F=l?S(v(),`courses/${l}/${g}`):S(v(),"courses");l?await Z(F,o):await _(F,o),T({message:"Item Submitted Successfully!",type:"success"})}catch(s){console.error("Error submitting form:",s),T({message:"Something went wrong!",type:"error"})}finally{C(!1)}},x=t=>{E(s=>{const a={...s,[t]:!s[t]};return a[t]?(w(`${t}Title`),w(`${t}Description`),w(`${t}Image`)):(y(`${t}Title`,{type:"manual",message:"This field is required"}),y(`${t}Description`,{type:"manual",message:"This field is required"}),y(`${t}Image`,{type:"manual",message:"This field is required"})),a})},c=(t,s,a,r="text",u)=>e.jsxs("div",{className:"relative mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),r==="textarea"?e.jsx("textarea",{...j(s,{required:i[u]&&!l?"This field is required":!1,minLength:i[u]?10:0}),className:`mt-1 block w-full pl-3 pr-12 py-2 border ${m[s]?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`,placeholder:a}):e.jsx("input",{type:r,...j(s,{required:i[u]&&!l?"This field is required":!1,minLength:i[u]?3:0}),className:`mt-1 block w-full pl-3 pr-12 py-2 border ${m[s]?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500`,placeholder:a}),m[s]&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:m[s].message})]}),f=(t,s,a)=>e.jsxs("div",{className:"relative mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",...j(s,{required:i[a]&&!l?"This field is required":!1}),className:"mt-1 block w-full pl-3 py-2 text-sm text-gray-900 border border-gray-300 rounded-md shadow-sm cursor-pointer focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"}),d[s]&&e.jsx("img",{src:d[s],alt:"Preview",className:"mt-4 h-48 w-auto border rounded-md"}),m[s]&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:m[s].message})]});return B?e.jsx(J,{}):e.jsxs(e.Fragment,{children:[P&&e.jsx(te,{}),e.jsxs("div",{className:"flex flex-col items-center py-12 bg-gray-50",children:[D.message&&e.jsx(K,{message:D.message,type:D.type,onClose:()=>T({message:"",type:""})}),e.jsxs("form",{onSubmit:U(A),className:"w-full max-w-4xl p-6 bg-white shadow-lg rounded-lg space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-indigo-600 text-center",children:[l?"Edit":"Add"," Course Details"]}),e.jsxs("div",{className:"border-b pb-6",children:[e.jsxs("h3",{className:"text-2xl font-semibold mb-4 text-gray-800 flex justify-between items-center",children:["Our Course Offerings",e.jsx("button",{type:"button",onClick:()=>x("student"),className:"text-indigo-600",children:i.student?e.jsx(b,{size:24}):e.jsx(I,{size:24})})]}),i.student&&e.jsxs(e.Fragment,{children:[c("Title","studentTitle","Enter Title","text","student"),c("Description","studentDescription","Enter Description","textarea","student"),f("Image","studentImage","student")]})]}),e.jsxs("div",{className:"border-b pb-6",children:[e.jsxs("h3",{className:"text-2xl font-semibold mb-4 text-gray-800 flex justify-between items-center",children:["Courses for Teachers",e.jsx("button",{type:"button",onClick:()=>x("teacher"),className:"text-indigo-600",children:i.teacher?e.jsx(b,{size:24}):e.jsx(I,{size:24})})]}),i.teacher&&e.jsxs(e.Fragment,{children:[c("Title","teacherTitle","Enter Title","text","teacher"),c("Description","teacherDescription","Enter Description","textarea","teacher"),f("Image","teacherImage","teacher")]})]}),e.jsxs("div",{className:"border-b pb-6",children:[e.jsxs("h3",{className:"text-2xl font-semibold mb-4 text-gray-800 flex justify-between items-center",children:["Courses for College",e.jsx("button",{type:"button",onClick:()=>x("college"),className:"text-indigo-600",children:i.college?e.jsx(b,{size:24}):e.jsx(I,{size:24})})]}),i.college&&e.jsxs(e.Fragment,{children:[c("Title","collegeTitle","Enter Title","text","college"),c("Description","collegeDescription","Enter Description","textarea","college"),f("Image","collegeImage","college")]})]}),e.jsxs("div",{className:"border-b pb-6",children:[e.jsxs("h3",{className:"text-2xl font-semibold mb-4 text-gray-800 flex justify-between items-center",children:["Teaching Methods",e.jsx("button",{type:"button",onClick:()=>x("method"),className:"text-indigo-600",children:i.method?e.jsx(b,{size:24}):e.jsx(I,{size:24})})]}),i.method&&e.jsxs(e.Fragment,{children:[c("Title","methodTitle","Enter Title","text","method"),c("Description","methodDescription","Enter Description","textarea","method"),f("Image","methodImage","method")]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-6 py-3 rounded-md shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit"})})]})]})]})};export{ae as default};
