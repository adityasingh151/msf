import{r,g as p,b as x,o as g,d as M,j as e,L as R,k,i as U,C as V,e as $,F as N}from"./index-C1Md3IU_.js";import{M as v}from"./Modal-DhpaDZAq.js";import A from"./NotificationForm-Clh9xgAk.js";import"./index.esm-CSBi2Yp2.js";import"./Saving-5cbZdhLL.js";import"./SuccessNotification-BG_7mmcG.js";const z=()=>{const[y,u]=r.useState([]),[w,c]=r.useState(!0),[h,b]=r.useState(null),[E,m]=r.useState(!1),[D,f]=r.useState(!1),[l,j]=r.useState(null);r.useEffect(()=>{const t=p(),s=x(t,"notifications"),a=g(s,i=>{const d=i.val()||{},o=Object.keys(d).map(n=>({id:n,...d[n],timestamp:N(d[n].timestamp)}));o.sort((n,L)=>L.timestamp-n.timestamp),u(o),c(!1)},i=>{console.error(i),b("Failed to fetch notifications"),c(!1)});return()=>M(s,"value",a)},[]);const O=async()=>{const t=k(),s=U(t,l.pdfUrl);try{await V(s),await $(x(p(),`notifications/${l.id}`)),m(!1),alert("Notification deleted successfully!")}catch(a){console.error("Error removing notification: ",a),alert("Failed to delete notification.")}},C=t=>{j(t),m(!0)},S=t=>{j(t),f(!0)},F=()=>{f(!1);const t=p(),s=x(t,"notifications");g(s,a=>{const i=a.val()||{},d=Object.keys(i).map(o=>({id:o,...i[o],timestamp:N(i[o].timestamp)}));d.sort((o,n)=>n.timestamp-o.timestamp),u(d),c(!1)},a=>{console.error(a),b("Failed to fetch notifications"),c(!1)})};return w?e.jsx(R,{}):h?e.jsxs("div",{children:["Error: ",h]}):e.jsxs("div",{className:"mx-auto py-4 px-6",children:[e.jsxs(v,{isOpen:E,onClose:()=>m(!1),title:"Confirm Deletion",children:[e.jsxs("p",{children:["Are you sure you want to delete the notification titled '",l==null?void 0:l.heading,"'? This action cannot be undone."]}),e.jsx("button",{onClick:O,className:"bg-red-500 hover:bg-red-700 text-white py-1 px-3 rounded mt-4",children:"Delete"})]}),e.jsx(v,{isOpen:D,onClose:()=>f(!1),title:"Edit Notification",children:e.jsx(A,{existingData:l,onSave:F})}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Notifications"}),y.map((t,s)=>e.jsxs("div",{className:"relative border p-4 rounded mb-2 flex justify-between items-center",children:[s<3&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-600 text-white text-xs font-semibold px-2 py-1 rounded",children:"Latest"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:t.heading}),e.jsxs("p",{className:"text-sm",children:["Date: ",t.date]}),e.jsxs("p",{className:"text-sm",children:["Year: ",t.year]}),e.jsx("a",{href:t.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View PDF"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>C(t),className:"bg-red-500 hover:bg-red-700 text-white py-1 px-3 rounded mr-2",children:"Delete"}),e.jsx("button",{onClick:()=>S(t),className:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-3 rounded",children:"Edit"})]})]},t.id))]})};export{z as default};
